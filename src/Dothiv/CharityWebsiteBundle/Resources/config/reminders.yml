parameters:
    dothiv.charity.sendwithus_renderer.class: Dothiv\CharityWebsiteBundle\SendWithUs\TemplateRenderer
    dothiv.charity.userreminder.mailer.class: Dothiv\CharityWebsiteBundle\UserReminder\UserReminderMailer

# TODO: move the template id config to a config setting
services:
    dothiv.charity.userreminder.nonprofit_approved_not_registered:
        class: Dothiv\CharityWebsiteBundle\UserReminder\NonProfitApplication\ApprovedNotRegisteredReminder
        tags:
        - { name: dothiv.userreminder, type: "nonprofit_approved_not_registered" }
        arguments:
        - @dothiv.repository.nonprofitregistration
        - @dothiv.repository.domain
        - @dothiv.repository.userreminder
        - @clock
        - {en: ["tem_2YUuqg7BMYyHUubMDkX4CW", "ver_nidDyCHJevjK2NcFy4eBfE"], de: ["tem_2YUuqg7BMYyHUubMDkX4CW", "ver_5txVjMsoruW69Eb8oxC5sJ"]}
        - @dothiv.charity.userreminder.mailer

    dothiv.charity.userreminder.nonprofit.click_counter_configured_but_no_clicks:
        class: Dothiv\CharityWebsiteBundle\UserReminder\NonProfitDomain\ClickCounterConfiguredButNoClicksReminder
        # tags:
        # - { name: dothiv.userreminder, type: "nonprofit_click_counter_configured_but_no_clicks" }
        arguments:
        - @dothiv.repository.domain
        - @dothiv.repository.userreminder
        - @clock
        - {en: ["xxx", "xxx"]}
        - @dothiv.charity.userreminder.mailer

    dothiv.charity.userreminder.nonprofit_registered_but_not_online:
        class: Dothiv\CharityWebsiteBundle\UserReminder\NonProfitApplication\RegisteredButNotOnline
        tags:
        - { name: dothiv.userreminder, type: "registered_but_not_online" }
        arguments:
        - @dothiv.repository.nonprofitregistration
        - @dothiv.repository.domain
        - @dothiv_hiv_domain_status.repository.check
        - @dothiv.repository.userreminder
        - @clock
        - {en: ["tem_dRysVqesLGMysMiNj7z4fF", "ver_i2J2ZrgYDV9U4dvYXa4cue"], de: ["tem_dRysVqesLGMysMiNj7z4fF", "ver_By97YcdCbqt2pZZNaaHW6i"]}
        - @dothiv.charity.userreminder.mailer

    dothiv.charity.userreminder.domain.online_but_click_counter_not_configured.nonprofit:
        class: Dothiv\CharityWebsiteBundle\UserReminder\Domain\OnlineButClickCounterNotConfigured
        tags:
        - { name: dothiv.userreminder, type: "domain_online_but_click_counter_not_configured_nonprofit" }
        arguments:
        - @dothiv.repository.domain
        - @dothiv_hiv_domain_status.repository.check
        - @dothiv.repository.userreminder
        - @clock
        - {en: ["tem_nfKoz3EGq7XiopxydULgQG", "ver_TQ4BgrgPsPzA7ALVuUqD4G"]}
        - @dothiv.charity.userreminder.mailer
        calls:
        - [setAfter, ["-4 weeks"]]
        - [setNonProfit, ["1"]]

    dothiv.charity.userreminder.domain.online_but_click_counter_not_configured.forprofit:
        class: Dothiv\CharityWebsiteBundle\UserReminder\Domain\OnlineButClickCounterNotConfigured
        tags:
        - { name: dothiv.userreminder, type: "domain_online_but_click_counter_not_configured_forprofit" }
        arguments:
        - @dothiv.repository.domain
        - @dothiv_hiv_domain_status.repository.check
        - @dothiv.repository.userreminder
        - @clock
        - {en: ["tem_nfKoz3EGq7XiopxydULgQG", "ver_TQ4BgrgPsPzA7ALVuUqD4G"]}
        - @dothiv.charity.userreminder.mailer
        calls:
        - [setAfter, ["-2 weeks"]]
        - [setNonProfit, ["0"]]

    dothiv.charity.userreminder.domain.telltheworld.forprofit:
        class: Dothiv\CharityWebsiteBundle\UserReminder\Domain\TellTheWorld
        tags:
        - { name: dothiv.userreminder, type: "tell_the_world_forprofit" }
        arguments:
        - @dothiv.repository.domain
        - @dothiv.repository.domain_whois
        - @dothiv.repository.userreminder
        - @clock
        - { templates: { en: "tem_LkcjjcYkCBetkV37FSfdrb", de: "tem_RFokjpCcpEYmwfmmZqfLdW" }, attachments: [ { space: xfj3l4zlkg3j, id: 7xCEHA40bCo0muQc6ieyme }, { space: xfj3l4zlkg3j, id: 2pr9w6gSXakaIgWQwGmSuq } ] }
        - @dothiv.charity.userreminder.mailer
        calls:
        - [setNonProfit, ["0"]]

    dothiv.charity.userreminder.domain.telltheworld.nonprofit:
        class: Dothiv\CharityWebsiteBundle\UserReminder\Domain\TellTheWorld
        tags:
        - { name: dothiv.userreminder, type: "tell_the_world_nonprofit" }
        arguments:
        - @dothiv.repository.domain
        - @dothiv.repository.domain_whois
        - @dothiv.repository.userreminder
        - @clock
        - { templates: { en: "tem_LkcjjcYkCBetkV37FSfdrb", de: "tem_RFokjpCcpEYmwfmmZqfLdW" }, attachments: [ { space: xfj3l4zlkg3j, id: 3XrGEdGW6sK4QYsikqos8u }, { space: xfj3l4zlkg3j, id: 3xgBfqG6zCm6yIOUM4MY6e } ] }
        - @dothiv.charity.userreminder.mailer
        calls:
        - [setNonProfit, ["1"]]

    dothiv.charity.sendwithus_renderer:
        class: %dothiv.charity.sendwithus_renderer.class%
        arguments:
        - %sendwithus_apikey%

    dothiv.charity.userreminder.mailer:
        class: %dothiv.charity.userreminder.mailer.class%
        arguments:
            - @swiftmailer.mailer.charity
            - @dothiv.charity.sendwithus_renderer
            - @dothiv_contentful.asset
            - @dothiv_contentful.repo.asset
            - %charity_email_from_address%
            - %charity_email_from_name%
